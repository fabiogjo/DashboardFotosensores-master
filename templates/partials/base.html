{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Fotosensores - Dashboard</title>
    <link rel="icon" type="image/x-icon" href="{% static 'fotosensores.png'%}">
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,400;0,600;1,200;1,400;1,600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'datatable_paralisados.css' %}">
    
    
    <link rel="stylesheet" type="text/css" href="{% static 'style.css' %}">
</head>
<body>


    {% block content %}

    {% endblock %}


    <!-- DataTables -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js"></script>
    <script src="//cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
    <script src="//cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
    <script src="//cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script scr="//cdn.datatables.net/plug-ins/1.12.1/dataRender/datetime.js"></script>



    <!-- CHARTS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.8.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="{% static 'charts.js' %}"></script>


    <!-- ICONS -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>




    <!-- MODALS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>



    <script src="{% static 'consulta_ticket.js' %}"></script>

    

    <script>





            // CODIGO DE PESQUISA DA TOP BAR

            $(document).ready(function(){
              $("#searchInput").on("keyup", function() {
                var value = $(this).val().toUpperCase().replaceAll(' ','');
                if (value.length < 3){
                    $('.card').show();
                } else {
                    $('.card').css('display','none');
                    $('.' + value).show();
                }


              });
            });


        $(document).ready(function(){

            $(document).on('click', '.editar_paralisado', function(){

                var equipamento_id = $(this).attr("id");

                if(equipamento_id !== ''){

                    var dados = {

                        equipamento_id: equipamento_id

                    };

                }

            });

        });





        $(".status").click(function(){
          $(".verified").removeClass("is-invalid");
          $(".verified").removeClass("is-invalid");
          $(".verified").removeClass("is-invalid");
          $(".verified").removeClass("is-invalid");

        });


		$('#exampleModal').on('show.bs.modal', function (event) {
          var button = $(event.relatedTarget) // Button that triggered the modal
          var id = button.data('id')
          var serial = button.data('serial')
          var municipio = button.data('municipio')
          var faixa = button.data('faixa')
          var motivo = button.data('motivo')
          var data_de_abertura = button.data('data_de_abertura')
          var data_de_encerramento = button.data('data_de_encerramento')
          var status = button.data('status')
          var modal = $(this)
          modal.find('.modal-title').text('Editar paralisação' + ' ' + serial + ' ' + municipio)
          modal.find('#id').val(id)
          modal.find('#serial :selected').text(serial)
          modal.find('#municipio').val(municipio)
          modal.find('#faixa').val(faixa)
          modal.find('#motivo').val(motivo)
          modal.find('#data_de_abertura').val(data_de_abertura)
          modal.find('#data_de_encerramento').val(data_de_encerramento)
          modal.find('#status').val(status)
        })

        $('#modalTicket').on('show.bs.modal', function (event) {
              var button = $(event.relatedTarget) // Button that triggered the modal
              var id_ticket = button.data('id_ticket')
              var dias_aberto = button.data('dias_aberto')
              var equipamento = button.data('equipamento')
              var tipo = button.data('tipo')
              var ticket_status = button.data('ticket_status')
              var agente_responsavel = button.data('agente')
              var assunto = button.data('assunto').toUpperCase()
              var modal = $(this)
              modal.find('#infos_ticket_id').html(id_ticket)
              modal.find('#infos_dias_abertos').html(dias_aberto)
              modal.find('#infos_agente').html(agente_responsavel)
              modal.find('#infos_status').html(ticket_status)
              modal.find('.modal-title').html(assunto)
              modal.find('#abrir_no_freshdesk').attr('href', 'https://fotosensores-dnit.freshdesk.com/a/tickets/'+id_ticket).attr('target', '_blank')

              modal.find('#id').val(id_ticket)
              modal.find('#equipamento_id').val(equipamento)
              modal.find('#status_ticket option:selected').text(ticket_status)
              modal.find('#agente_responsavel option:selected').text(agente_responsavel)


        })

        $('#form_altera_situacao_paralisado').on('show.bs.modal', function (event) {

            var button = $(event.relatedTarget) // Button that triggered the modal

            var situacao = button.data('situacao')

            var equipamento = button.data('equip')

            var modal = $(this)
            
            situacao = situacao.replaceAll(' ','');
            situacao = situacao.replaceAll('/','');

            modal.find('#equipId').attr('value', equipamento)

            modal.find('#Radio'+situacao).prop('checked',true)

            


        })


        $('#notificacoes').on('show.bs.modal', function (event) {
              var button = $(event.relatedTarget) // Button that triggered the modal


        })


        // add hovered class in selected list item

        let list = document.querySelectorAll('.navigation li');
        function activeLink(){
            list.forEach((item) =>
            item.classList.remove('hovered'));
            this.classList.add('hovered');
        }
        list.forEach((item) =>
        item.addEventListener('mouseover', activeLink));


        function MostraCategoria(categoria) {
            
            var y = document.querySelectorAll('.CategoriaParalisado li')
            var x = document.getElementById(categoria);

            if (x.style.display === "none") {
                for (let i = 0; i < y.length; i++) {
                    var z = document.querySelectorAll('.cards_equipamentos_tickets')
                    z[i].style.display = "none";
                    }
                x.style.display = "grid";
            } else {
                x.style.display = "none";
            }
        }

        function MostraCategoriaOperando(categoria) {
            
            var y = document.querySelectorAll('.CategoriaOperando li')
            var x = document.getElementById(categoria);

            if (x.style.display === "none") {
                for (let i = 0; i < y.length; i++) {
                    var z = document.querySelectorAll('#operando .cards_equipamentos_tickets')
                    z[i].style.display = "none";
                    }
                x.style.display = "grid";
            } else {
                x.style.display = "none";
            }
        }

        function addClass(objeto, classe) {

            var x = objeto.parentNode.classList[0];

            var y = document.querySelectorAll('.' + x + ' li')

            for (let i = 0; i < y.length; i++) {
                
                y[i].classList.remove('hover')

            }

            objeto.classList.add(classe)
        }
        






    </script>
</body>
</html>